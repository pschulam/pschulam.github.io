<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Blog System | Peter Schulam</title> <meta name="author" content="Peter Schulam"/> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "/> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üåä</text></svg>"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://pschulam.github.io/blog/2024/blog-system/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Peter¬†</span>Schulam</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Blog System</h1> <p class="post-meta">January 5, 2024</p> <p class="post-tags"> <a href="/blog/2024"> <i class="fas fa-calendar fa-sm"></i> 2024 </a> </p> </header> <article class="post-content"> <h1 id="how-my-site-uses-github-pages">How My Site Uses Github Pages</h1> <p>To quickly setup my personal site a few years ago, I pulled an <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">often used</a> academic website template built on <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> and configured to deploy on Github Pages. The system worked smoothly, but it‚Äôs been a while since I‚Äôve used it and in the meantime some of the pieces have stopped working. In this post, I describe the system and the modifications I‚Äôve made to get everything working together again.</p> <h2 id="tools">Tools</h2> <p>The system uses Github Pages to host the site and Github Actions to deploy it.</p> <h3 id="github-pages">Github Pages</h3> <p>The main <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">product page</a> states that you can host websites directly from your github repository: ‚ÄúJust edit, push, and your changes are live‚Äù. You can create two kinds of sites: account/organization sites (limited to just one), and unlimited project sites. For account/organization sites, the basic product is straightforward. You create a repository with a specific name (this is important so that Github knows that the repository is intended to be an account site), and then you use the repository as the ‚Äúroot‚Äù of your site by commiting an <code class="language-plaintext highlighter-rouge">index.html</code> file to it. Push the change you commit, and the site will be available.</p> <p>Pages serves static sites. This means, roughly, that the web server will map paths in the HTTP request to a stored object (could be a file in a file system, a chunk of bytes stored in a database, whatever) and returns the content as-is to the client. Unconfigured, Pages will serve the files saved in a Git repository on a given branch (<code class="language-plaintext highlighter-rouge">master</code> or <code class="language-plaintext highlighter-rouge">mainline</code> by default).</p> <p>In my site, I have two branches: <a href="https://github.com/pschulam/pschulam.github.io/tree/master" target="_blank" rel="noopener noreferrer">master</a> and <a href="https://github.com/pschulam/pschulam.github.io/tree/gh-pages" target="_blank" rel="noopener noreferrer">gh-pages</a>. The <code class="language-plaintext highlighter-rouge">master</code> branch contains all the source files that Jekyll uses to generate the site pages, and the <code class="language-plaintext highlighter-rouge">gh-pages</code> branch contains the Jekyll output that Pages actually serves. These two branches, in general, are called the ‚Äúsource‚Äù and the ‚Äúdeploy‚Äù branches. To change the deploy branch, go to your repository‚Äôs <code class="language-plaintext highlighter-rouge">Settings &gt; Pages</code> and change the branch (there is also additional flexibility to deploy from a specific directory within a given branch). You can directly develop in the deploy branch (in which case there is no source branch), or you can use a build process to translate source artifacts into the final site. My site uses the ‚Äúsource and deploy branches‚Äù approach, and uses Github Actions for the build.</p> <h3 id="github-actions">Github Actions</h3> <p>Github Actions is a CI/CD platform. The key concept is a <em>workflow</em> which describes a collection of <em>jobs</em> that run in response to <em>triggers</em>. In many ways, Actions works like the front end to a cluster workload manager such as <a href="https://slurm.schedmd.com/documentation.html" target="_blank" rel="noopener noreferrer">Slurm</a> or <a href="https://kubernetes.io/" target="_blank" rel="noopener noreferrer">Kubernetes</a>. A workflow is defined using a YAML file and stored in the <code class="language-plaintext highlighter-rouge">.github/workflows</code> directory of your repo.</p> <p>A trigger is an event that kicks off the jobs in a workflow. This is usually an event in the repo (e.g. you push a change or merge a pull request), but can also be a scheduled trigger (like a chron job) or a manual trigger.</p> <p>A job is a sequence of <em>steps</em> that are configured to run on a given machine. Each step can either be a script or an <em>action</em>, which is a reusable, configurable step. To specify where a job runs, you set the <code class="language-plaintext highlighter-rouge">runs-on</code> key in the configuration file. Github provides a small number of VM images for public repositories that are free to use. The options are listed <a href="https://docs.github.com/en/actions/writing-workflows/choosing-where-your-workflow-runs/choosing-the-runner-for-a-job#standard-github-hosted-runners-for-public-repositories" target="_blank" rel="noopener noreferrer">here</a>. Actions supports running workflows on larger hosted machines (e.g. one with a GPU) or on self-hosted machines, but I won‚Äôt cover that here.</p> <p>For the site setup I‚Äôve forked, Actions push content from <code class="language-plaintext highlighter-rouge">master</code> to <code class="language-plaintext highlighter-rouge">gh-pages</code>. The workflows are defined <a href="https://github.com/pschulam/pschulam.github.io/tree/master/.github/workflows" target="_blank" rel="noopener noreferrer">here</a>. Let‚Äôs break down how they work. We‚Äôve got three workflows:</p> <ul> <li> <a href="https://github.com/pschulam/pschulam.github.io/blob/master/.github/workflows/deploy-docker-tag.yml" target="_blank" rel="noopener noreferrer">deploy-docker-tag.yml</a>: Triggers when we push a tag that matches <code class="language-plaintext highlighter-rouge">v*</code>. There‚Äôs only one job. It checks out the repo, sets up an environment to build docker images, then builds the image using the <code class="language-plaintext highlighter-rouge">./Dockerfile</code> in the repo root. It then pushes to <code class="language-plaintext highlighter-rouge">[amirpourmand/al-folio](https://hub.docker.com/r/amirpourmand/al-folio)</code> on Dockerhub. I don‚Äôt ever use this.</li> <li> <a href="https://github.com/pschulam/pschulam.github.io/blob/master/.github/workflows/deploy-image.yml" target="_blank" rel="noopener noreferrer">deploy-image.yml</a>: Similar to the <code class="language-plaintext highlighter-rouge">deploy-docker-tag.yml</code> workflow, but builds whenever we push to <code class="language-plaintext highlighter-rouge">master</code> and we‚Äôre the original author (which we‚Äôre not). The difference between this workflow and <code class="language-plaintext highlighter-rouge">deploy-docker-tag.yml</code> seems to be that the latter adds some metadata (my guess is the tag).</li> <li> <a href="https://github.com/pschulam/pschulam.github.io/blob/master/.github/workflows/deploy.yml" target="_blank" rel="noopener noreferrer">deploy.yml</a>: This is the core workflow that builds my site. It has a single <code class="language-plaintext highlighter-rouge">deploy</code> job comprised of 5 steps (two actions and three scripts). The two actions (1) checkout the repo and (2) setup ruby. The scripts run afterwards and (1) installs the <code class="language-plaintext highlighter-rouge">mermaid</code> CLI tool, (2) configures git and sets some state based on the triggering event, and (3) runs the <code class="language-plaintext highlighter-rouge">./bin/deploy</code> script in the repo. The <code class="language-plaintext highlighter-rouge">./bin/deploy</code> script is where the bulk of the work happens. In a nutshell, the <code class="language-plaintext highlighter-rouge">./bin/deploy</code> script will checkout the source branch, build the site, move the <code class="language-plaintext highlighter-rouge">./_site</code> contents to the repo root (so that Pages will serve the content), create a new local deploy branch (deleting it if it exists), add the built site, then force push to the <code class="language-plaintext highlighter-rouge">origin</code> remote.</li> </ul> <p>Once the deploy branch is pushed to Github (<code class="language-plaintext highlighter-rouge">remote</code>), Pages will serve the new content!</p> <h2 id="developing-locally">Developing Locally</h2> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gem <span class="nb">install </span>bundler jekyll
bundle <span class="nb">install
</span>bundle <span class="nb">exec </span>jekyll serve
</code></pre></div></div> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> ¬© Copyright 2025 Peter Schulam. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="noopener noreferrer">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>